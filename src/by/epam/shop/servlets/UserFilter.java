package by.epam.shop.servlets;import by.epam.shop.models.User;import javax.servlet.*;import javax.servlet.annotation.WebFilter;import javax.servlet.http.HttpServletRequest;import javax.servlet.http.HttpServletResponse;import javax.servlet.http.HttpSession;import java.io.IOException;/** * This class responsible for filtering users * * @author Alex Evstratenko * @version 1.10 10 Sep 2018 */@WebFilter(filterName = "UserFilter",        urlPatterns = {"/index.html", "/user.html", "/cart.html", "/admin.html"})public class UserFilter implements Filter {    @Override    public void init(FilterConfig filterConfig) {    }    @Override    public void doFilter(ServletRequest request, ServletResponse response, FilterChain filterChain) throws IOException, ServletException {        HttpServletRequest httpServletRequest = (HttpServletRequest) request;        HttpServletResponse httpServletResponse = (HttpServletResponse) response;        HttpSession session = httpServletRequest.getSession();        /**         * Try to get user from session         */        User user = (User) session.getAttribute("user");        String uri = httpServletRequest.getRequestURI();        /**         * Check user from session         */        if (user != null) {            if (user.getRole() == User.Role.ADMIN) {                RequestDispatcher rd = request.getRequestDispatcher("/admin.html");                rd.forward(request, response);            } else if (uri.equals("/cart.html")) {                RequestDispatcher rd = request.getRequestDispatcher("/cart.html");                rd.forward(request, response);            } else {                RequestDispatcher rd = request.getRequestDispatcher("/user.html");                rd.forward(request, response);            }        } else {            if (!uri.equals("/index.html")) {                httpServletResponse.sendRedirect("/index.html");            } else                filterChain.doFilter(request, response);        }    }    @Override    public void destroy() {    }}